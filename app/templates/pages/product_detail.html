{% extends 'base.html' %}
{% load static %}

{% block title %}Product{% endblock %}

{% block header_right %}
    {% include 'base/components/_breadcrumbs.html' with breadcrumbs=breadcrumbs %}
{% endblock %}

{% block content %}
<main>
    <section class="main-grid">
        <!-- Картинка -->
        <div class="pt-28 md:lg-8 col-span-full lg:col-span-7 xl:col-start-2 xl:col-span-6">
            <div class="product_picture [ w-full aspect-[2/3] overflow-hidden ]">
                <img src="{% static 'dist/images/figure.jpg' %}" class="object-cover w-full h-full" alt="Презервативы DR.JOYS классические">
            </div>
        </div>

        <!-- Инфо -->
        <div class="col-span-full lg:col-span-7 lg:col-start-9 xl:col-start-9 xl:col-span-5">
            <div class="pt-4 xl:pt-50 lg:pt-40 h-full flex flex-col">
                <div class="flex flex-col gap-8">
                    <div class="border-b-[0.5px] border-b-black pb-8">
                        <h5 class="text-sm tracking-wide text-red-500 mb-2 font-bold">ХИТ ПРОДАЖ</h5>
                        <h1 class="h2 br-lg font-benzin uppercase">Презервативы DR.JOYS <span> классические, банан,</span> <span>0.02 мм, 5 шт.</span></h1>
                    </div>
                    <div class="flex justify-between shrink-1">
                        <span class="text-xs uppercase tracking-wider flex items-center gap-2 font-medium">АРТИКУЛ <span class="h-4 border-l-1"></span> 123456</span>
                        <span class="text-md font-benzin text-red-500 uppercase tracking-wider flex items-center gap-2 font-bold">3 540 ₸</span>
                    </div>
                    <!-- BEGIN buy section -->
                    <div class="product-buy" id="productBuy">
                        <!-- Initial state: Buy + Favorite buttons -->
                        <div class="flex gap-2" id="buyButtons">
                            <button class="btn-cat flex-1 font-benzin" type="button" id="buyAnonymousBtn">КУПИТЬ АНОНИМНО</button>
                            <button class="btn-favorite" type="button" id="productFavoriteBtn" aria-label="Добавить в избранное">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M20.84 4.61a5.5 5.5 0 00-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 00-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 000-7.78z"/>
                                </svg>
                            </button>
                        </div>
                        <!-- Size selector (hidden by default) -->
                        <div class="hidden" id="sizeSelector">
                            <p class="text-xs font-bold pb-2">Выберите размер:</p>
                            <div class="size-selector">
                                <button class="size-chip" type="button" data-size="M" data-dims="52×180мм" data-available="true">
                                    M
                                    <span class="size-chip__dims">52×180мм</span>
                                </button>
                                <button class="size-chip" type="button" data-size="L" data-dims="54×190мм" data-available="true">
                                    L
                                    <span class="size-chip__dims">54×190мм</span>
                                </button>
                                <button class="size-chip disabled" type="button" data-size="XL" data-dims="56×200мм" data-available="false" disabled>
                                    XL
                                    <span class="size-chip__dims">Нет в наличии</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    <!-- END buy section -->
                    <div>
                        <p class=" text-sm">
                            Гладкая поверхность, латекс бесцветный. С дополнительной
                            <span>силиконовой смазкой, с нейтральным ароматом, толщина 0.02</span>
                            мм неощутимые на 95%
                        </p>
                    </div>
                </div>
                <div class="lg:mt-auto mt-4 pt-8 lg:pb-4">
                    <ul class="flex flex-col gap-3">
                        <li class="product_links-item"><a href="#characters" class="w-full block">СОСТАВ И ХАРАКТЕРИСТИКИ</a></li>
                        <li class="product_links-item"><a href="" class="w-full block">Как правильно выбрать размер</a></li>
                        <li class="product_links-item"><a href="" class="w-full block">Инструкция по применению</a></li>
                        <li class="product_links-item"><a href="" class="w-full block">противопоказания</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <section class="main-grid lg:mt-24">
        <!-- Меню 1 -->
        <div class="col-span-full lg:col-span-7 xl:col-start-3 xl:col-span-5 flex ">
            <div id="characters" class="mt-auto pt-12 pb-8 lg:pb-4 w-full">
                <ul class="mt-auto flex flex-col gap-6">
                    <li class="flex flex-col text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">материал</span>
                        <span class="br-lg">Ультратонкие 0,02 мм, натуральный латекс</span>
                    </li>
                    <li class="flex flex-col text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Особенности</span>
                        <span class="br-lg">Сверхпрочные, особо увлажненные</span>
                    </li>
                    <li class="flex flex-col text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Комплектация</span>
                        <span class="br-lg">Презервативы классические - 5 шт, <span>Упаковка (пачка) - 1 шт</span></span>
                    </li>
                    <li class="flex flex-col md:flex-row text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Срок годности –</span>
                        <span class="br-lg">60 мес</span>
                    </li>
                    <li class="flex flex-col md:flex-row text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Страна производства –</span>
                        <span class="br-lg">Китай</span>
                    </li>
                </ul>
            </div>
        </div>

        <!-- Меню 2 -->
        <div class="col-span-full lg:col-span-7 lg:col-start-9 xl:col-start-9 xl:col-span-6 ">
            <div class="product-zoom-container w-full h-full aspect-[2/3] overflow-hidden">
                <!-- data-rotate контролирует градус поворота -->
                <img
                        src="{% static 'dist/images/product-refs.jpg' %}"
                        class="product-zoom-image w-full h-full object-cover"
                        data-rotate="15"
                        alt="Презервативы DR.JOYS"
                >
            </div>
        </div>
    </section>

    <section class="main-grid mt-8 lg:mt-24">
        <!-- Слайдер 1 -->
        <div class="col-span-full col-start-0 md:col-span-3 lg:col-span-7 xl:col-start-2 xl:col-span-6 flex flex-col">
            <div class="[ product-slider ] w-full h-full aspect-[2/3] overflow-hidden relative" data-autoplay="true" data-interval="2000">
                <!-- Картинки -->
                <img src="{% static 'dist/images/upakovka.jpg' %}" class="slider-image" alt="Упаковка вид 3">
                <img src="{% static 'dist/images/upakovka-1.jpg' %}" class="slider-image" alt="Упаковка вид 3">
                <img src="{% static 'dist/images/upakovka-2.jpg' %}" class="slider-image" alt="Упаковка вид 3">

                <!-- Круговой прогресс с кнопкой pause/play -->
                <div class="slider-progress-wrapper">
                    <svg class="slider-progress-circle" viewBox="0 0 36 36">
                        <circle class="progress-bg" cx="18" cy="18" r="16"></circle>
                        <circle class="progress-bar" cx="18" cy="18" r="16"></circle>
                    </svg>
                    <button class="slider-play-pause" type="button" aria-label="Pause slideshow">
                        <!-- Pause icon -->
                        <svg class="pause-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="2" y="2" width="2" height="8" fill="currentColor"/>
                            <rect x="8" y="2" width="2" height="8" fill="currentColor"/>
                        </svg>
                        <!-- Play icon -->
                        <svg class="play-icon hidden" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 2L10 6L3 10V2Z" fill="currentColor"/>
                        </svg>
                    </button>
                </div>

                <!-- Индикаторы -->
                <div class="slider-indicators"></div>
            </div>
            <div>
                <p class="text-xs italic text-right py-2">Упаковка презервативов DR.JOYS</p>
            </div>
        </div>

        <!-- Слайдер 2 -->
        <div class="col-span-full lg:col-start-9 md:col-span-3 lg:col-span-7 xl:col-start-9 xl:col-span-6 flex flex-col">
            <div class="[ product-slider ] w-full h-full aspect-[2/3] overflow-hidden relative" data-autoplay="true" data-interval="2000">
                <!-- Картинки -->
                <img src="{% static 'dist/images/paket.jpg' %}" class="slider-image" alt="Пакет вид 3">
                <img src="{% static 'dist/images/paket-1.jpg' %}" class="slider-image" alt="Пакет вид 3">
                <img src="{% static 'dist/images/paket-2.jpg' %}" class="slider-image" alt="Пакет вид 3">

                <!-- Круговой прогресс с кнопкой pause/play -->
                <div class="slider-progress-wrapper">
                    <svg class="slider-progress-circle" viewBox="0 0 36 36">
                        <circle class="progress-bg" cx="18" cy="18" r="16"></circle>
                        <circle class="progress-bar" cx="18" cy="18" r="16"></circle>
                    </svg>
                    <button class="slider-play-pause" type="button" aria-label="Pause slideshow">
                        <svg class="pause-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="2" y="2" width="2" height="8" fill="currentColor"/>
                            <rect x="8" y="2" width="2" height="8" fill="currentColor"/>
                        </svg>
                        <svg class="play-icon hidden" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 2L10 6L3 10V2Z" fill="currentColor"/>
                        </svg>
                    </button>
                </div>

                <!-- Индикаторы -->
                <div class="slider-indicators"></div>
            </div>
            <div>
                <p class="text-xs italic text-right py-2">Презерватив в индивидуальной упаковке</p>
            </div>
        </div>
    </section>

    <section class="mt-8 lg:mt-24 py-8">
        <div class="main-grid">
            <div class="col-span-full xl:col-start-2">
                <h2 class="h2 font-benzin uppercase mb-8">Вам может быть интересно</h2>
            </div>
        </div>
        <div class="flex ">
            <!-- Карусель -->
            <div class="carousel-wrapper">
                <div class="carousel-track">
                    <!-- Карточки (добавь столько сколько нужно) -->
                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Неощутимые на 95% 0.02 мм, 5 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Классические 0.03 мм, 10 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Ребристые 0.02 мм, 3 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS XXL увеличенные 0.03 мм, 5 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Точечные 0.02 мм, 5 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Mix набор 0.02 мм, 12 шт.</h3>
                            </div>
                        </a>
                    </article>
                </div>

                <!-- Кастомный курсор -->
                <div class="carousel-cursor"></div>
            </div>
        </div>
    </section>
</main>

{% block shop_ui %}
{% include 'base/components/_floating_nav.html' %}
{% include 'base/components/_modal_cart.html' %}
{% include 'base/components/_modal_favorites.html' %}
{% include 'base/components/_modal_profile.html' %}
{% include 'base/components/_modal_auth.html' %}
{% include 'base/components/_modal_order_quantity.html' %}
{% include 'base/components/_modal_delivery.html' %}
{% include 'base/components/_modal_success.html' %}
{% endblock %}

{% block scripts %}
<!-- YouTube Player API -->
<script src="https://www.youtube.com/iframe_api"></script>

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<script>
// --------------------------------------------
// 7. ZOOM ЭФФЕКТ ДЛЯ КАРТИНКИ ТОВАРА ПРИ СКРОЛЛЕ
// --------------------------------------------
function initProductZoom() {
    // Проверяем что GSAP загружен
    if (typeof gsap === 'undefined') {
        console.warn('GSAP не загружен - zoom эффект не работает');
        return;
    }

    const zoomImages = document.querySelectorAll('.product-zoom-image');

    if (zoomImages.length === 0) return;

    // Регистрируем плагин ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    zoomImages.forEach(image => {
        const container = image.closest('.product-zoom-container');
        if (!container) return;

        // Получаем градус поворота из data-атрибута (по умолчанию 15)
        const rotationDegree = parseFloat(image.getAttribute('data-rotate')) || 15;

        // Создаем GSAP анимацию
        gsap.fromTo(image,
            {
                // Начальное состояние
                scale: 1,
                rotation: 0,
            },
            {
                // Конечное состояние
                scale: 1.5,  // Увеличение на 30%
                rotation: rotationDegree,  // Поворот из data-rotate
                ease: "none",  // Линейная анимация для плавности со скроллом
                scrollTrigger: {
                    trigger: container,
                    start: "top bottom",  // Начинаем когда верх контейнера достигает низа экрана
                    end: "bottom top",    // Заканчиваем когда низ контейнера достигает верха экрана
                    scrub: 1,  // Плавная синхронизация со скроллом (1 секунда задержки)
                    // markers: true,  // Раскомментируй для отладки
                }
            }
        );
    });
}

// Инициализируем после загрузки
window.addEventListener('load', initProductZoom);
</script>
{% endblock %}


{% endblock %}