{% extends 'base.html' %}
{% load static %}

{% block title %}Product{% endblock %}

{% block header_right %}
    {% include 'base/components/_breadcrumbs.html' with breadcrumbs=breadcrumbs %}
{% endblock %}

{% block content %}
<main>
    <section class="main-grid">
        <!-- Картинка -->
        <div class="col-span-full lg:col-start-3 lg:col-span-6">
            <div class="product_picture [ w-full aspect-[2/3] overflow-hidden ]">
                <img src="{% static 'dist/images/figure.jpg' %}" class="object-cover w-full h-full" alt="Презервативы DR.JOYS классические">
            </div>
        </div>

        <!-- Инфо -->
        <div class="col-span-full lg:col-start-10 lg:col-span-5">
            <div class="pt-50 h-full flex flex-col">
                <div class="flex flex-col gap-8">
                    <div class="border-b-[0.5px] border-b-black pb-8">
                        <h5 class="text-sm tracking-wide text-red-500 mb-2 font-bold">ХИТ ПРОДАЖ</h5>
                        <h1 class="h2 br-lg font-benzin uppercase">Презервативы DR.JOYS <span> классические, банан,</span> <span>0.02 мм, 5 шт.</span></h1>
                    </div>
                    <div>
                        <span class="text-xs uppercase tracking-wider flex items-center gap-2">АРТИКУЛ <span class="h-4 border-l-1"></span> 123456</span>
                    </div>
                    <div class="add-to-cart">
                        <div class="cart-button-wrapper">
                            <button class="btn-cat w-full font-benzin">КУПИТЬ АНОНИМНО</button>
                        </div>
                        <div class="cart-links-wrapper hidden py-3">
                            <a href="" class="btn-cat-list"><span class="uppercase">Wildberries</span> <span class="text-red-500">Нет в наличии</span></a>
                            <a href="" class="btn-cat-list"><span class="uppercase">Ozon</span></a>
                            <a href="" class="btn-cat-list"><span class="uppercase">teez</span></a>
                            <a href="" class="btn-cat-list"><span class="uppercase">joystoys</span></a>
                            <a href="" class="btn-cat-list"><span class="uppercase">blackrabbit</span></a>
                        </div>
                    </div>
                    <div>
                        <p class="br-lg text-sm">
                            Гладкая поверхность, латекс бесцветный. С дополнительной
                            <span>силиконовой смазкой, с нейтральным ароматом, толщина 0.02</span>
                            мм неощутимые на 95%
                        </p>
                    </div>
                </div>
                <div class="lg:mt-auto mt-12 pt-8 pb-4">
                    <ul class="flex flex-col gap-3">
                        <li class="product_links-item"><a href="#characters" class="w-full block">СОСТАВ И ХАРАКТЕРИСТИКИ</a></li>
                        <li class="product_links-item"><a href="" class="w-full block">Как правильно выбрать размер</a></li>
                        <li class="product_links-item"><a href="" class="w-full block">Инструкция по применению</a></li>
                        <li class="product_links-item"><a href="" class="w-full block">противопоказания</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <section class="main-grid mt-24">
        <div class="lg:col-start-3 lg:col-span-6 col-span-full flex ">
            <div id="characters" class="mt-auto pt-12 pb-4">
                <ul class="mt-auto flex flex-col gap-6">
                    <li class="flex flex-col text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">материал</span>
                        <span class="br-lg">Ультратонкие 0,02 мм, натуральный латекс</span>
                    </li>
                    <li class="flex flex-col text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Особенности  </span>
                        <span class="br-lg">Сверхпрочные, особо увлажненные</span>
                    </li>
                    <li class="flex flex-col text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Комплектация  </span>
                        <span class="br-lg">Презервативы классические - 5 шт, <span>Упаковка (пачка) - 1 шт</span></span>
                    </li>
                    <li class="flex text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Срок годности –</span>
                        <span class="br-lg">60 мес</span>
                    </li>
                    <li class="flex text-sm gap-1">
                        <span class="uppercase font-benzin tracking-wider">Страна производства –</span>
                        <span class="br-lg">Китай</span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="lg:col-start-9 lg:col-span-6 col-span-full">
            <div class="product-zoom-container w-full h-full aspect-[2/3] overflow-hidden">
                <!-- data-rotate контролирует градус поворота -->
                <img
                        src="{% static 'dist/images/product-refs.jpg' %}"
                        class="product-zoom-image w-full h-full object-cover"
                        data-rotate="15"
                        alt="Презервативы DR.JOYS"
                >
            </div>
        </div>
    </section>


    <section class="main-grid mt-24">
        <!-- Слайдер 1 -->
        <div class="lg:col-start-2 lg:col-span-6 col-span-full flex flex-col">
            <div class="[ product-slider ] w-full h-full aspect-[2/3] overflow-hidden relative" data-autoplay="true" data-interval="2000">
                <!-- Картинки -->
                <img src="{% static 'dist/images/upakovka.jpg' %}" class="slider-image" alt="Упаковка вид 3">
                <img src="{% static 'dist/images/upakovka-1.jpg' %}" class="slider-image" alt="Упаковка вид 3">
                <img src="{% static 'dist/images/upakovka-2.jpg' %}" class="slider-image" alt="Упаковка вид 3">

                <!-- Круговой прогресс с кнопкой pause/play -->
                <div class="slider-progress-wrapper">
                    <svg class="slider-progress-circle" viewBox="0 0 36 36">
                        <circle class="progress-bg" cx="18" cy="18" r="16"></circle>
                        <circle class="progress-bar" cx="18" cy="18" r="16"></circle>
                    </svg>
                    <button class="slider-play-pause" type="button" aria-label="Pause slideshow">
                        <!-- Pause icon -->
                        <svg class="pause-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="2" y="2" width="2" height="8" fill="currentColor"/>
                            <rect x="8" y="2" width="2" height="8" fill="currentColor"/>
                        </svg>
                        <!-- Play icon -->
                        <svg class="play-icon hidden" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 2L10 6L3 10V2Z" fill="currentColor"/>
                        </svg>
                    </button>
                </div>

                <!-- Индикаторы -->
                <div class="slider-indicators"></div>
            </div>
            <div>
                <p class="text-xs italic text-right py-2">Упаковка презервативов DR.JOYS</p>
            </div>
        </div>

        <!-- Слайдер 2 -->
        <div class="lg:col-start-9 lg:col-span-6 col-span-full flex flex-col">
            <div class="[ product-slider ] w-full h-full aspect-[2/3] overflow-hidden relative" data-autoplay="true" data-interval="2000">
                <!-- Картинки -->
                <img src="{% static 'dist/images/paket.jpg' %}" class="slider-image" alt="Пакет вид 3">
                <img src="{% static 'dist/images/paket-1.jpg' %}" class="slider-image" alt="Пакет вид 3">
                <img src="{% static 'dist/images/paket-2.jpg' %}" class="slider-image" alt="Пакет вид 3">

                <!-- Круговой прогресс с кнопкой pause/play -->
                <div class="slider-progress-wrapper">
                    <svg class="slider-progress-circle" viewBox="0 0 36 36">
                        <circle class="progress-bg" cx="18" cy="18" r="16"></circle>
                        <circle class="progress-bar" cx="18" cy="18" r="16"></circle>
                    </svg>
                    <button class="slider-play-pause" type="button" aria-label="Pause slideshow">
                        <svg class="pause-icon" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <rect x="2" y="2" width="2" height="8" fill="currentColor"/>
                            <rect x="8" y="2" width="2" height="8" fill="currentColor"/>
                        </svg>
                        <svg class="play-icon hidden" width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 2L10 6L3 10V2Z" fill="currentColor"/>
                        </svg>
                    </button>
                </div>

                <!-- Индикаторы -->
                <div class="slider-indicators"></div>
            </div>
            <div>
                <p class="text-xs italic text-right py-2">Презерватив в индивидуальной упаковке</p>
            </div>
        </div>
    </section>

    <section class="mt-24 py-8">
        <div class="main-grid">
            <div class="col-span-full col-start-2">
                <h2 class="h2 font-benzin uppercase mb-8">Вам может быть интересно</h2>
            </div>
        </div>
        <div class="flex ">
            <!-- Карусель -->
            <div class="carousel-wrapper">
                <div class="carousel-track">
                    <!-- Карточки (добавь столько сколько нужно) -->
                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Неощутимые на 95% 0.02 мм, 5 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Классические 0.03 мм, 10 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Ребристые 0.02 мм, 3 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS XXL увеличенные 0.03 мм, 5 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Точечные 0.02 мм, 5 шт.</h3>
                            </div>
                        </a>
                    </article>

                    <article class="carousel-card">
                        <a href="" class="block">
                            <div class="carousel-card_picture">
                                <img src="{% static 'dist/images/figure.jpg' %}" class="w-full h-full object-cover" alt="Презервативы DR.JOYS">
                                <div class="product-card_label" aria-hidden="true">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <rect width="16" height="16" rx="1" fill="currentColor"/>
                                        <path d="M7.64286 3H8.35714V13H7.64286V3Z" fill="white"/>
                                        <path d="M3 8.35714L3 7.64286L13 7.64286V8.35714L3 8.35714Z" fill="white"/>
                                    </svg>
                                </div>
                            </div>
                            <div class="carousel-card_info">
                                <h3 class="text-sm uppercase tracking-wider">Презервативы DR.JOYS Mix набор 0.02 мм, 12 шт.</h3>
                            </div>
                        </a>
                    </article>
                </div>

                <!-- Кастомный курсор -->
                <div class="carousel-cursor"></div>
            </div>
        </div>
    </section>
</main>

{% block scripts %}
<!-- YouTube Player API -->
<script src="https://www.youtube.com/iframe_api"></script>

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<script>
// --------------------------------------------
// 7. ZOOM ЭФФЕКТ ДЛЯ КАРТИНКИ ТОВАРА ПРИ СКРОЛЛЕ
// --------------------------------------------
function initProductZoom() {
    // Проверяем что GSAP загружен
    if (typeof gsap === 'undefined') {
        console.warn('GSAP не загружен - zoom эффект не работает');
        return;
    }

    const zoomImages = document.querySelectorAll('.product-zoom-image');

    if (zoomImages.length === 0) return;

    // Регистрируем плагин ScrollTrigger
    gsap.registerPlugin(ScrollTrigger);

    zoomImages.forEach(image => {
        const container = image.closest('.product-zoom-container');
        if (!container) return;

        // Получаем градус поворота из data-атрибута (по умолчанию 15)
        const rotationDegree = parseFloat(image.getAttribute('data-rotate')) || 15;

        // Создаем GSAP анимацию
        gsap.fromTo(image,
            {
                // Начальное состояние
                scale: 1,
                rotation: 0,
            },
            {
                // Конечное состояние
                scale: 1.5,  // Увеличение на 30%
                rotation: rotationDegree,  // Поворот из data-rotate
                ease: "none",  // Линейная анимация для плавности со скроллом
                scrollTrigger: {
                    trigger: container,
                    start: "top bottom",  // Начинаем когда верх контейнера достигает низа экрана
                    end: "bottom top",    // Заканчиваем когда низ контейнера достигает верха экрана
                    scrub: 1,  // Плавная синхронизация со скроллом (1 секунда задержки)
                    // markers: true,  // Раскомментируй для отладки
                }
            }
        );
    });
}

// Инициализируем после загрузки
window.addEventListener('load', initProductZoom);
</script>

{% endblock %}


{% endblock %}