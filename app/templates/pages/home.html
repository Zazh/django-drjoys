{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block content %}
<main class="mt-[7.5rem] lg:mt-[7.5rem]">

<!-- Hero -->
<section id="home-hero">
    <div class="mb-6">
        <h1 class="text-center pb-5 flex flex-col
                   text-2xl md:text-[2.5rem] leading-tight font-benzin uppercase">
            <span>Ультратонкие</span> <span>презервативы </span><span>DR.JOYS</span>
        </h1>
        <h2 class="flex flex-wrap justify-center text-sm lg:text-xl font-medium leading-tight">
            <span class="flex justify-center gap-1 w-full">Неощутимые на 95% <span class="lg:text-sm text-xs mb-auto">(0,02 мм)</span></span>
            <span class="flex justify-center w-full">Тоньше волоса, прочнее стали</span>
        </h2>
    </div>

    <div class="hero-carousel-container gap-2 lg:gap-0 flex justify-center items-center relative pb-6 pt-12 h-[23rem] max-lg:px-[30%] max-lg:justify-start">
            <!-- Card 1 -->
            <div class="w-[240px]">
                <div class="hero-carousel-card bg-white" data-parallax>
                    <!-- background -->
                    <div class="hero-carousel-card_layer [ rotate-[4deg] ] [ flex items-center justify-center ]" data-depth="0.2">
                        <div class="hero-carousel-card_bg [ bg-gradient-to-b from-[#ACE143] to-[#D7E422] ]">
                            <img src="{% static 'dist/images/hero/prod_bg/gl.svg' %}" data-depth="0.4" alt="" class="absolute -top-[1rem] -left-[1rem]">
                            <img src="{% static 'dist/images/hero/prod_bg/gr.svg' %}" data-depth="-0.4" alt="" class="absolute -top-[1rem] -right-[1rem]">
                        </div>
                    </div>

                    <!-- Product image -->
                    <div class="hero-carousel-card_layer [ flex justify-center ]" data-depth="-0.2">
                        <div class="w-[80%] relative">
                            <img src="{% static 'dist/images/hero/1.png' %}" class="absolute bottom-10 hero-carousel-card-product_img">
                        </div>
                    </div>

                    <!-- Count -->
                    <div class="hero-carousel-card_layer [ flex justify-end ]" data-depth="1.5">
                        <div class="w-[45%] relative">
                            <img src="{% static 'dist/images/hero/counter/5.svg' %}" class="w-full absolute bottom-8 -right-[1.5rem] ">
                        </div>
                    </div>

                    <!-- Light spark -->
                    <div class="hero-carousel-card_layer [ flex justify-center items-center ]" data-depth="0.5">
                        <div class="w-full relative z-50">
                            <img src="{% static 'dist/images/hero/light.svg' %}" class="">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 2 -->
            <div class="w-[240px]">
                <div class="hero-carousel-card bg-white [ active ]" data-parallax>
                    <!-- background -->
                    <div class="hero-carousel-card_layer [ rotate-[1deg] ] [ flex items-center justify-center ]" data-depth="0.2">
                        <div class="hero-carousel-card_bg [ bg-gradient-to-b from-[#FE70BA] to-[#F3971C] ]">
                            <svg data-depth="0.4" class="absolute -bottom-[4.5rem] -right-[2rem] w-[17rem]" viewBox="0 0 337 395" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M297.668 94.9485C230.919 49.738 140.159 67.1977 94.9482 133.946C49.7377 200.694 67.1975 291.455 133.946 336.666L94.7949 394.467C-3.87654 327.634 -29.6867 193.467 37.1463 94.7951C103.979 -3.87626 238.147 -29.6864 336.819 37.1466L297.668 94.9485Z" fill="url(#paint0_linear_2029_83)"/>
                                <defs>
                                    <linearGradient id="paint0_linear_2029_83" x1="247.488" y1="-23.3593" x2="5.46467" y2="333.961" gradientUnits="userSpaceOnUse">
                                        <stop stop-color="#F42296"/>
                                        <stop offset="1" stop-color="#FDFF7E"/>
                                    </linearGradient>
                                </defs>
                            </svg>
                        </div>
                    </div>

                    <!-- Product image -->
                    <div class="hero-carousel-card_layer [ flex justify-center ]" data-depth="-0.2">
                        <div class="w-[70%] relative product-image">
                            <img src="{% static 'dist/images/hero/2.png' %}" class="absolute bottom-10 hero-carousel-card-product_img">
                        </div>
                    </div>

                    <!-- Count -->
                    <div class="hero-carousel-card_layer [ flex justify-end ]" data-depth="1.5">
                        <div class="w-[60%] relative">
                            <img src="{% static 'dist/images/hero/counter/17.svg' %}" class="w-full absolute bottom-8 -right-[1.5rem]">
                        </div>
                    </div>

                    <!-- Light spark -->
                    <div class="hero-carousel-card_layer [ flex justify-center items-center ]" data-depth="0.5">
                        <div class="w-full relative z-50">
                            <img src="{% static 'dist/images/hero/light.svg' %}" class="">
                        </div>
                    </div>

                    <!-- Bundle -->
                    <div class="hero-carousel-card_layer [ flex justify-start items-center ]"  data-depth="-0.5">
                        <div class="inset-0 w-full aspect-square relative">
                            <img src="{% static 'dist/images/hero/top.svg' %}" class="absolute top-0 -left-[1.5rem]">
                        </div>
                    </div>
                </div>
            </div>

            <!-- Card 3 -->
            <div class="w-[240px]">
                <div class="hero-carousel-card bg-white " data-parallax>
                    <!-- background -->
                    <div class="hero-carousel-card_layer [ -rotate-[4deg] ] [ flex items-center justify-center ]" data-depth="0.2">
                        <div class="hero-carousel-card_bg [ bg-gradient-to-b from-[#AF87DF] to-[#5C40AE] ]" data-depth="-0.2">
                            <img src="{% static 'dist/images/hero/prod_bg/ic.svg' %}" data-depth="0.4" alt="" class="w-[17rem] absolute bottom-0 -left-[1rem]">
                        </div>
                    </div>

                    <!-- Product image -->
                    <div class="hero-carousel-card_layer [ flex justify-center ]" data-depth="-0.2">
                        <div class="w-[80%] relative">
                            <img src="{% static 'dist/images/hero/3.png' %}" class="absolute bottom-10 hero-carousel-card-product_img">
                        </div>
                    </div>

                    <!-- Count -->
                    <div class="hero-carousel-card_layer [ flex justify-end ]" data-depth="1.5">
                        <div class="w-[50%] relative">
                            <img src="{% static 'dist/images/hero/counter/30.svg' %}" class="w-full absolute bottom-10 -right-[1.5rem]">
                        </div>
                    </div>

                    <!-- Light spark -->
                    <div class="hero-carousel-card_layer [ flex justify-center items-center ]">
                        <div class="w-full relative z-50">
                            <img src="{% static 'dist/images/hero/light.svg' %}" class="">
                        </div>
                    </div>
                </div>
            </div>
        </div>

    <div class="flex justify-center items-center gap-2 pb-10">
        <button class="btn-macro default">В каталог</button>
        <button class="btn-macro danger">Купить</button>
    </div>
</section>

<!-- Presentation block -->
<section id="features" class="features ">
    <div class="features-carousel">
        <div class="features-cursor"></div>
        <div class="features-card">
            <div class="features-card-container">
                <div>
                    <h1 class="display-2">1 Тоньше волоса</h1>
                </div>
                <div class="features-card-content">
                    <p>Толщина человеческого волоса и «ультратонких» презервативов других брендов - 0,05 мм. DR.JOYS имеют толщину всего 0,02 мм, что делает их на 95% неощутимыми.</p>
                    <p>Только такая толщина позволяет сохранять живое тепло партнера и чувствовать каждое сокращение мышц.</p>
                </div>
            </div>
            <div class="absolute inset-0 z-0">
                <img class="features-bg-img" src="{% static 'dist/images/features/1.jpg' %}" alt="">
            </div>
        </div>
        <div class="features-card">
            <div class="features-card-container">
                <div>
                    <h1 class="display-2">2 Тоньше волоса</h1>
                </div>
                <div class="features-card-content">
                    <p>Толщина человеческого волоса и «ультратонких» презервативов других брендов - 0,05 мм. DR.JOYS имеют толщину всего 0,02 мм, что делает их на 95% неощутимыми.</p>
                    <p>Только такая толщина позволяет сохранять живое тепло партнера и чувствовать каждое сокращение мышц.</p>
                </div>
            </div>
            <div class="absolute inset-0 z-0">
                <img class="features-bg-img" src="{% static 'dist/images/features/1.jpg' %}" alt="">
            </div>
        </div>
        <div class="features-card">
            <div class="features-card-container">
                <div>
                    <h1 class="display-2">3 Тоньше волоса</h1>
                </div>
                <div class="features-card-content">
                    <p>Толщина человеческого волоса и «ультратонких» презервативов других брендов - 0,05 мм. DR.JOYS имеют толщину всего 0,02 мм, что делает их на 95% неощутимыми.</p>
                    <p>Только такая толщина позволяет сохранять живое тепло партнера и чувствовать каждое сокращение мышц.</p>
                </div>
            </div>
            <div class="absolute inset-0 z-0">
                <img class="features-bg-img" src="{% static 'dist/images/features/1.jpg' %}" alt="">
            </div>
        </div>
    </div>

    <!-- Controls -->
    <div class="absolute bottom-14 flex justify-center items-center w-full">
        <div class="features-controls">
            <div class="features-dots">
                <button class="features-dot active" data-index="0"></button>
                <button class="features-dot" data-index="1"></button>
                <button class="features-dot" data-index="2"></button>
            </div>
            <button class="features-pause">
                <svg class="pause-icon" width="14" height="16" viewBox="0 0 14 16" fill="none">
                    <rect width="4" height="16" rx="1" fill="white"/>
                    <rect x="10" width="4" height="16" rx="1" fill="white"/>
                </svg>
                <svg class="play-icon hidden" width="14" height="16" viewBox="0 0 14 16" fill="none">
                    <path d="M14 8L0 16V0L14 8Z" fill="white"/>
                </svg>
            </button>
        </div>
    </div>
</section>

<!-- Quizzes block -->
<section id="quizzes" class="quizzes" data-parallax >
    <div class="quizzes-container ">
        <div class="quizzes-content ">
            <div class="w-full">
                <h2 class="text-white hyphens-auto
                            text-2xl md:text-[2.5rem] leading-tight font-benzin uppercase">
                    Не можешь <br>Определи&shy;ться?</h2>
                <p class="font-medium text-white text-sm md:text-lg leading-tight mt-5">Пройди короткий тест и узнай, какой <span class="md:block">DR.JOYS подходит именно тебе</span></p>
            </div>
            <div class="w-full mt-auto text-center md:text-left">
                <button type="button" class="btn-macro white-opacity">Пройти опрос</button>
            </div>
        </div>

        <div class="quizzes-girl">
            <img src="{% static 'dist/images/quizzes/girl.png' %}" class="w-full" alt="Девушка с продуктом">
        </div>
        <div class="quizzes-heart"  data-depth="0.85">
            <img src="{% static 'dist/images/quizzes/heart.png' %}" class="w-full object-cover" alt="">
        </div>
    </div>
</section>

<!-- Reviews block -->
<section id="reviews" class="reviews" data-parallax >
    <div class="w-full max-w-screen-lg mx-auto">
        <div class="lg:pb-10">
            <h2 class="display-1">
                <span class="flex flex-wrap items-center justify-center md:gap-2">
                    <span class="w-full md:w-auto -mb-3 md:mb-0 text-center">Более</span>
                    <span class="w-[260px] md:w-[240px] lg:w-[440px] shrink-0 relative">
                        <span class="relative md:absolute md:-bottom-6.5 lg:-bottom-12 w-full z-10" data-depth="0.5">
                            <img src="{% static 'dist/images/reviews/label_counter.png' %}" alt="" class="object-contain w-full h-full object-top-left">
                        </span>
                        <span class="reviews-counter-shadow w-[80%] ml-[10%] h-1 absolute top-5 md:-top-2 lg:-top-2 z-0" data-depth="-0.5"></span>
                    </span>
                    <span class="w-full md:w-auto text-center">заказов</span>
                </span>
                <span class="flex justify-center flex-wrap md:gap-2">
                    <span class="hyphens-auto w-full md:w-auto text-center">на маркет&shy;плейсах</span>
                    <span class="hyphens-auto w-full md:w-auto text-center">со средней</span>
                </span>
                <span class="flex flex-wrap items-center justify-center md:gap-2">
                    <span class="hyphens-auto text-center block w-full md:w-auto">оценкой</span>
                    <span class="w-[160px] md:w-[130px] lg:w-[242px] shrink-0 relative lg:absolute">
                        <span class="relative md:absolute md:-bottom-9 lg:-bottom-22 lg:-right-65 w-full z-10" data-depth="-0.65">
                            <img src="{% static 'dist/images/reviews/label_ranked.svg' %}" alt="" class="object-contain w-full h-full object-top-left">
                        </span>
                        <span class="reviews-shadow-alt w-[70%] ml-[20%] h-4 absolute top-10 md:-top-1.5 lg:-right-57 lg:top-1 z-0" data-depth="0.5"></span>
                    </span>
                </span>
            </h2>
        </div>
        <div class="flex justify-center pt-2 pb-8 lg:py-8">
            <div class="md:w-lg m-auto text-center text-lg leading-tight font-medium px-5 md:px-0">
                <p>Всего 2,4% негативных отзывов. Мы за честный фидбек, поэтому не стесняемся, а наоборот — отвечаем с удовольствием :)</p>
            </div>
        </div>
        <div class="flex justify-center py-2">
            <ul class="flex gap-3 md:gap-4 flex-col md:flex-row">
                <li>
                    <button type="button" class="reviews-filter btn-macro black font-sans inline-flex gap-2 text-base" data-filter="positive">
                        <span>Понравилось</span> <span class="opacity-55">1248</span>
                    </button>
                </li>
                <li>
                    <button type="button" class="reviews-filter btn-macro light font-sans inline-flex gap-2 text-base" data-filter="negative">
                        <span>Не понравилось</span> <span class="opacity-55">48</span>
                    </button>
                </li>
            </ul>
        </div>
    </div>
</section>

<!-- Reviews carousel block -->
<section id="reviews-carousel" class="reviews-carousel">
    <div class="reviews-carousel-wrapper">
        <!-- Стрелка влево -->
        <button class="reviews-arrow reviews-arrow--prev">
            <svg  class="rotate-180" width="68" height="60" viewBox="0 0 68 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M38.3946 60L33.3061 54.9107L54.2546 33.683L-5.88933e-06 33.683L-4.6014e-06 26.317L54.2546 26.317L33.3061 5.15626L38.3946 6.71312e-06L68 30L38.3946 60Z" fill="currentColor"/>
            </svg>
        </button>
        <!-- Стрелка вправо -->
        <button class="reviews-arrow reviews-arrow--next">
            <svg width="68" height="60" viewBox="0 0 68 60" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M38.3946 60L33.3061 54.9107L54.2546 33.683L-5.88933e-06 33.683L-4.6014e-06 26.317L54.2546 26.317L33.3061 5.15626L38.3946 6.71312e-06L68 30L38.3946 60Z" fill="currentColor"/>
            </svg>
        </button>

        <div class="reviews-carousel-track">
            <div class="reviews-carousel-slide">
                <div class="comment-card">
                    <!-- Review -->
                    <div class="comment-card__review">
                        <!-- Header -->
                        <div class="comment-card__header">
                            <div class="comment-card__main">
                                <div class="rating rating-bg [ rating-1 ]">
                                    <div class="rating-fill"></div>
                                </div>
                                <div class="comment-card__name">
                                    <span>Сафа1</span>
                                    <span>|</span>
                                    <span>24 нояб. 2025</span>
                                </div>
                            </div>
                            <div class="comment-card__side">
                                <div class="comment-card__tools"></div>
                            </div>
                        </div>
                        <!-- END Header -->

                        <!-- Body -->
                        <div class="comment-card__body">
                            <ul class="comment-card__list">
                                <li>
                                    <span class="comment-card__title">Достоинства</span>
                                    <p>Эффект неощутимости</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Недостатки</span>
                                    <p>Не заметила</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Комментарий</span>
                                    <p>
                                        lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    </p>
                                </li>
                            </ul>
                        </div>
                        <!-- END Body -->
                    </div>
                    <!-- END Review -->

                    <!-- Answer -->
                    <div class="comment-card__answer bg-slate-50">
                        <div class="comment-card__answer-title">
                            <div class="reply-icon"></div>
                            <span>Ответ Dr.Joys</span>
                        </div>
                        <div class="comment-card__answer-body">
                            lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                        </div>
                    </div>
                    <!-- END Answer -->
                </div>
            </div>
            <div class="reviews-carousel-slide">
                <div class="comment-card">
                    <!-- Review -->
                    <div class="comment-card__review">
                        <!-- Header -->
                        <div class="comment-card__header">
                            <div class="comment-card__main">
                                <div class="rating rating-bg [ rating-1 ]">
                                    <div class="rating-fill"></div>
                                </div>
                                <div class="comment-card__name">
                                    <span>Сафа2</span>
                                    <span>|</span>
                                    <span>24 нояб. 2025</span>
                                </div>
                            </div>
                            <div class="comment-card__side">
                                <div class="comment-card__tools"></div>
                            </div>
                        </div>
                        <!-- END Header -->

                        <!-- Body -->
                        <div class="comment-card__body">
                            <ul class="comment-card__list">
                                <li>
                                    <span class="comment-card__title">Достоинства</span>
                                    <p>Эффект неощутимости</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Недостатки</span>
                                    <p>Не заметила</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Комментарий</span>
                                    <p>
                                        lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    </p>
                                </li>
                            </ul>
                        </div>
                        <!-- END Body -->
                    </div>
                    <!-- END Review -->

                    <!-- Answer -->
                    <div class="comment-card__answer bg-slate-50">
                        <div class="comment-card__answer-title">
                            <div class="reply-icon"></div>
                            <span>Ответ Dr.Joys</span>
                        </div>
                        <div class="comment-card__answer-body">
                            lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                        </div>
                    </div>
                    <!-- END Answer -->
                </div>
            </div>
            <div class="reviews-carousel-slide">
                <div class="comment-card">
                    <!-- Review -->
                    <div class="comment-card__review">
                        <!-- Header -->
                        <div class="comment-card__header">
                            <div class="comment-card__main">
                                <div class="rating rating-bg [ rating-1 ]">
                                    <div class="rating-fill"></div>
                                </div>
                                <div class="comment-card__name">
                                    <span>Сафа3</span>
                                    <span>|</span>
                                    <span>24 нояб. 2025</span>
                                </div>
                            </div>
                            <div class="comment-card__side">
                                <div class="comment-card__tools"></div>
                            </div>
                        </div>
                        <!-- END Header -->

                        <!-- Body -->
                        <div class="comment-card__body">
                            <div class="comment-card__text">
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci architecto distinctio eaque molestias mollitia porro quidem, temporibus ut voluptatem? Accusamus asperiores culpa inventore laudantium magni nemo pariatur quas quidem, quisquam.
                            </div>

                            <ul class="comment-card__list">
                                <li>
                                    <span class="comment-card__title">Достоинства</span>
                                    <p>Эффект неощутимости</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Недостатки</span>
                                    <p>Не заметила</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Комментарий</span>
                                    <p>
                                        lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    </p>
                                </li>
                            </ul>

                            <div class="comment-card__meta">
                                <p class="comment-card__title">Плюсы товара</p>
                                <ul class="comment-card__tags">
                                    <li>отвыв как тег</li>
                                    <li>нет эффекта</li>
                                    <li>плохое качество</li>
                                </ul>
                            </div>
                        </div>
                        <!-- END Body -->
                    </div>
                    <!-- END Review -->

                    <!-- Answer -->
                    <div class="comment-card__answer bg-slate-50">
                        <div class="comment-card__answer-title">
                            <div class="reply-icon"></div>
                            <span>Ответ Dr.Joys</span>
                        </div>
                        <div class="comment-card__answer-body">
                            lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                        </div>
                    </div>
                    <!-- END Answer -->
                </div>
            </div>

            <div class="reviews-carousel-slide">
                <div class="comment-card">
                    <!-- Review -->
                    <div class="comment-card__review">
                        <!-- Header -->
                        <div class="comment-card__header">
                            <div class="comment-card__main">
                                <div class="rating rating-bg [ rating-1 ]">
                                    <div class="rating-fill"></div>
                                </div>
                                <div class="comment-card__name">
                                    <span>Сафа4</span>
                                    <span>|</span>
                                    <span>24 нояб. 2025</span>
                                </div>
                            </div>
                            <div class="comment-card__side">
                                <div class="comment-card__tools"></div>
                            </div>
                        </div>
                        <!-- END Header -->

                        <!-- Body -->
                        <div class="comment-card__body">
                            <ul class="comment-card__list">
                                <li>
                                    <span class="comment-card__title">Достоинства</span>
                                    <p>Эффект неощутимости</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Недостатки</span>
                                    <p>Не заметила</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Комментарий</span>
                                    <p>
                                        lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    </p>
                                </li>
                            </ul>
                        </div>
                        <!-- END Body -->
                    </div>
                    <!-- END Review -->

                    <!-- Answer -->
                    <div class="comment-card__answer bg-slate-50">
                        <div class="comment-card__answer-title">
                            <div class="reply-icon"></div>
                            <span>Ответ Dr.Joys</span>
                        </div>
                        <div class="comment-card__answer-body">
                            lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                        </div>
                    </div>
                    <!-- END Answer -->
                </div>
            </div>
            <div class="reviews-carousel-slide">
                <div class="comment-card">
                    <!-- Review -->
                    <div class="comment-card__review">
                        <!-- Header -->
                        <div class="comment-card__header">
                            <div class="comment-card__main">
                                <div class="rating rating-bg [ rating-1 ]">
                                    <div class="rating-fill"></div>
                                </div>
                                <div class="comment-card__name">
                                    <span>Сафа5</span>
                                    <span>|</span>
                                    <span>24 нояб. 2025</span>
                                </div>
                            </div>
                            <div class="comment-card__side">
                                <div class="comment-card__tools"></div>
                            </div>
                        </div>
                        <!-- END Header -->

                        <!-- Body -->
                        <div class="comment-card__body">
                            <div class="comment-card__text">
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci architecto distinctio eaque molestias mollitia porro quidem, temporibus ut voluptatem? Accusamus asperiores culpa inventore laudantium magni nemo pariatur quas quidem, quisquam.
                            </div>

                            <div class="comment-card__meta">
                                <p class="comment-card__title">Плюсы товара</p>
                                <ul class="comment-card__tags">
                                    <li>отвыв как тег</li>
                                    <li>нет эффекта</li>
                                    <li>плохое качество</li>
                                </ul>
                            </div>
                        </div>
                        <!-- END Body -->
                    </div>
                    <!-- END Review -->

                    <!-- Answer -->
                    <div class="comment-card__answer bg-slate-50">
                        <div class="comment-card__answer-title">
                            <div class="reply-icon"></div>
                            <span>Ответ Dr.Joys</span>
                        </div>
                        <div class="comment-card__answer-body">
                            lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                        </div>
                    </div>
                    <!-- END Answer -->
                </div>
            </div>
            <div class="reviews-carousel-slide">
                <div class="comment-card">
                    <!-- Review -->
                    <div class="comment-card__review">
                        <!-- Header -->
                        <div class="comment-card__header">
                            <div class="comment-card__main">
                                <div class="rating rating-bg [ rating-1 ]">
                                    <div class="rating-fill"></div>
                                </div>
                                <div class="comment-card__name">
                                    <span>Сафа6</span>
                                    <span>|</span>
                                    <span>24 нояб. 2025</span>
                                </div>
                            </div>
                            <div class="comment-card__side">
                                <div class="comment-card__tools"></div>
                            </div>
                        </div>
                        <!-- END Header -->

                        <!-- Body -->
                        <div class="comment-card__body">
                            <div class="comment-card__text">
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit. Adipisci architecto distinctio eaque molestias mollitia porro quidem, temporibus ut voluptatem? Accusamus asperiores culpa inventore laudantium magni nemo pariatur quas quidem, quisquam.
                            </div>

                            <ul class="comment-card__list">
                                <li>
                                    <span class="comment-card__title">Достоинства</span>
                                    <p>Эффект неощутимости</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Недостатки</span>
                                    <p>Не заметила</p>
                                </li>
                                <li>
                                    <span class="comment-card__title">Комментарий</span>
                                    <p>
                                        lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                                    </p>
                                </li>
                            </ul>

                            <div class="comment-card__meta">
                                <p class="comment-card__title">Плюсы товара</p>
                                <ul class="comment-card__tags">
                                    <li>отвыв как тег</li>
                                    <li>нет эффекта</li>
                                    <li>плохое качество</li>
                                </ul>
                            </div>
                        </div>
                        <!-- END Body -->
                    </div>
                    <!-- END Review -->

                    <!-- Answer -->
                    <div class="comment-card__answer bg-slate-50">
                        <div class="comment-card__answer-title">
                            <div class="reply-icon"></div>
                            <span>Ответ Dr.Joys</span>
                        </div>
                        <div class="comment-card__answer-body">
                            lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor
                        </div>
                    </div>
                    <!-- END Answer -->
                </div>
            </div>
        </div>


    </div>
    <div class="pt-5 pb-10 md:py-10">
        <div class="text-center">
            <button class="btn-wb">
                <span>Читать на WB</span>
            </button>
        </div>
    </div>
</section>

<!-- Go partners block -->
<section id="go-partners" class="go-partners">
    <div class="main-grid">
        <div class="go-partners-container">
            <div class="go-partners-content" data-parallax>
                <span class="lg:w-[320px] w-[160px] aspect-square shrink-0 absolute flex justify-center items-center [ -top-[15%] lg:-top-[20%] md:-top-[15%] right-0 md:-right-[20%] ]">
                    <span class="relative w-full z-10" data-depth="-0.65">
                        <img src="{% static 'dist/images/go_partner/accessory.png' %}" alt="" class="object-contain w-full h-full object-top-left">
                    </span>
                    <span class="reviews-shadow-alt md:mt-[20%] lg:mt-[50%] w-[50%] mx-auto h-4 absolute top-10 z-0" data-depth="0.5"></span>
                </span>
                <div>
                    <h2 class="display-1 md:hyphens-none">
                        Хотите <span class="block md:inline">зарабаты&shy;вать вместе</span> <span class="block md:inline">с DR.JOYS?</span>
                    </h2>
                </div>
                <div>
                    <p class="leading-tight text-sm lg:text-base">Каждый день мы получаем много заявок на оптовую реализацию продукции из разных стран. Если вы действующий дистрибьютор в своем городе или у вас сеть магазинов или аптек - оставляйте заявку и мы отправим вам коммерческое предложение с самыми выгодными оптовыми ценами. У каждого из наших партнеров DR.JOYS занимает первые места по продажам в категории барьерной контрацепции.</p>
                </div>
                <div class="py-2 hidden md:block">
                    <ul class="flex flex-wrap gap-2">
                        <li>
                            <button type="button" class="btn-macro default">Подробнее</button>
                        </li>
                        <li>
                            <button type="button" class="btn-macro danger">Оставить заявку</button>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="go-partners-side">
            <img src="{% static 'dist/images/go_partner/partner.jpg' %}" class="object-cover w-full h-full" alt="">
            <div class="absolute inset-0 flex items-end md:hidden">
                <ul class="flex flex-wrap gap-2 p-5">
                    <li>
                        <button type="button" class="btn-macro default">Подробнее</button>
                    </li>
                    <li>
                        <button type="button" class="btn-macro danger">Оставить заявку</button>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</section>

<!-- Events block -->
<section id="events" class="events ">
    <div class="events-container">
        <div class="flex flex-wrap gap-5 md:gap-10 shadow-[0_0_120px_30px_rgba(0,0,0,0.9)] bg-[#00000094] rounded-full">
            <div class="w-full lg:pt-8 text-white text-center">
                <h2 class="text-2xl md:text-[2.5rem] leading-tight font-benzin uppercase">
                    <span class="block">Пожизненный</span>
                    <span class="block">запас DR.JOYS</span>
                    <span class="block">за татуировку</span>
                </h2>
                <p class="text-sm lg:text-xl leading-tight pt-5 lg:pt-10">DR.JOYS для смелых. Наша миссия - ломать стереотипы и выйти за пределы стандартов и рамок, навязанных обществом. Мы делаем то, что боятся делать другие. Если ты разделяешь наши ценности, то смотри условия акции.</p>
            </div>
            <div class="w-full text-center absolute lg:static bottom-16">
                <button type="button" class="btn-macro danger hover:bg-white hover:text-red-500">Прочитать условие</button>
            </div>
        </div>
    </div>

    <!-- Images Gallery -->
    <div class="events-gallery" id="events-gallery">
        <div class="events-gallery_row">
            <div class="events-gallery_item">
                <img class="events-gallery-img" src="{% static 'dist/images/promo_events/1.jpg' %}" alt="">
            </div>
            <div class="events-gallery_item">
                <img class="events-gallery-img" src="{% static 'dist/images/promo_events/2.jpg' %}" alt="">
            </div>
        </div>
        <div class="events-gallery_row">
            <div class="events-gallery_item">
                <img class="events-gallery-img" src="{% static 'dist/images/promo_events/3.jpg' %}" alt="">
            </div>
            <div class="events-gallery_item">
                <img class="events-gallery-img" src="{% static 'dist/images/promo_events/4.jpg' %}" alt="">
            </div>
        </div>
    </div>
    <!-- END Images Gallery -->
</section>

<!-- Blog block -->
<section id="blog-widgets" class="blog-widgets">
    <div class="blog-widgets-container">
        <div class="main-grid">
            <div class="col-span-full lg:col-start-2">
                <div class="md:pt-12 md:pb-10 pb-8">
                    <h2 class="text-2xl md:text-[2.5rem] leading-tight font-benzin uppercase">
                        тут интересно, <br>почитай
                    </h2>
                </div>
            </div>
        </div>
        <div class="blog-carousel">
            <div class="blog-carousel-track">
                <div class="blog-carousel-slide">
                    <article class="blog-card" itemscope itemtype="https://schema.org/BlogPosting">
                        <a href="" class="blog-card-link">
                            <figure class="blog-card-figure">
                                <img
                                        class="blog-card-img"
                                        src="{% static 'dist/images/blog/1.jpg' %}"
                                        alt="Описание изображения статьи"
                                        loading="lazy"
                                        itemprop="image"
                                >
                            </figure>
                            <div class="blog-card-content">
                                <div class="blog-card-info">
                                    <div class="blog-card-title">
                                        <h3 class="text-sm md:text-xl" itemprop="headline">Натянули DR.JOYS на Кок-Тобе</h3>
                                    </div>
                                    <div class="blog-card-meta">
                                        <time datetime="2025-05-01" itemprop="datePublished">1 мая 2025</time>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </article>
                </div>
                <div class="blog-carousel-slide">
                    <article class="blog-card" itemscope itemtype="https://schema.org/BlogPosting">
                        <a href="" class="blog-card-link">
                            <figure class="blog-card-figure">
                                <img
                                        class="blog-card-img"
                                        src="{% static 'dist/images/blog/1.jpg' %}"
                                        alt="Описание изображения статьи"
                                        loading="lazy"
                                        itemprop="image"
                                >
                            </figure>
                            <div class="blog-card-content">
                                <div class="blog-card-info">
                                    <div class="blog-card-title">
                                        <h3 class="text-sm md:text-xl" itemprop="headline">Натянули DR.JOYS на Кок-Тобе</h3>
                                    </div>
                                    <div class="blog-card-meta">
                                        <time datetime="2025-05-01" itemprop="datePublished">1 мая 2025</time>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </article>
                </div>

                <div class="blog-carousel-slide">
                    <article class="blog-card" itemscope itemtype="https://schema.org/BlogPosting">
                        <a href="" class="blog-card-link">
                            <figure class="blog-card-figure">
                                <img
                                        class="blog-card-img"
                                        src="{% static 'dist/images/blog/1.jpg' %}"
                                        alt="Описание изображения статьи"
                                        loading="lazy"
                                        itemprop="image"
                                >
                            </figure>
                            <div class="blog-card-content">
                                <div class="blog-card-info">
                                    <div class="blog-card-title">
                                        <h3 class="text-sm md:text-xl" itemprop="headline">Натянули DR.JOYS на Кок-Тобе</h3>
                                    </div>
                                    <div class="blog-card-meta">
                                        <time datetime="2025-05-01" itemprop="datePublished">1 мая 2025</time>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </article>
                </div>

                <div class="blog-carousel-slide">
                    <article class="blog-card" itemscope itemtype="https://schema.org/BlogPosting">
                        <a href="" class="blog-card-link">
                            <figure class="blog-card-figure">
                                <img
                                        class="blog-card-img"
                                        src="{% static 'dist/images/blog/1.jpg' %}"
                                        alt="Описание изображения статьи"
                                        loading="lazy"
                                        itemprop="image"
                                >
                            </figure>
                            <div class="blog-card-content">
                                <div class="blog-card-info">
                                    <div class="blog-card-title">
                                        <h3 class="text-sm md:text-xl" itemprop="headline">Натянули DR.JOYS на Кок-Тобе</h3>
                                    </div>
                                    <div class="blog-card-meta">
                                        <time datetime="2025-05-01" itemprop="datePublished">1 мая 2025</time>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </article>
                </div>

                <div class="blog-carousel-slide">
                    <article class="blog-card" itemscope itemtype="https://schema.org/BlogPosting">
                        <a href="" class="blog-card-link">
                            <figure class="blog-card-figure">
                                <img
                                        class="blog-card-img"
                                        src="{% static 'dist/images/blog/1.jpg' %}"
                                        alt="Описание изображения статьи"
                                        loading="lazy"
                                        itemprop="image"
                                >
                            </figure>
                            <div class="blog-card-content">
                                <div class="blog-card-info">
                                    <div class="blog-card-title">
                                        <h3 class="text-sm md:text-xl" itemprop="headline">Натянули DR.JOYS на Кок-Тобе</h3>
                                    </div>
                                    <div class="blog-card-meta">
                                        <time datetime="2025-05-01" itemprop="datePublished">1 мая 2025</time>
                                    </div>
                                </div>
                            </div>
                        </a>
                    </article>
                </div>
            </div>
        </div>
    </div>
</section>

</main>

{% block scripts %}
<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<script>
    // --------------------------------------------
    // PARALLAX ЭФФЕКТ
    // --------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        const containers = document.querySelectorAll('[data-parallax]');
        const isMobile = window.innerWidth < 1024;

        containers.forEach(container => {
            const layers = container.querySelectorAll('[data-depth]');

            // Desktop: mousemove
            if (!isMobile) {
                container.addEventListener('mousemove', (e) => {
                    const rect = container.getBoundingClientRect();
                    const centerX = rect.left + rect.width / 2;
                    const centerY = rect.top + rect.height / 2;

                    const x = (e.clientX - centerX) / (rect.width / 2);
                    const y = (e.clientY - centerY) / (rect.height / 2);

                    layers.forEach(layer => {
                        const depth = parseFloat(layer.dataset.depth);
                        const moveX = x * 15 * depth;
                        const moveY = y * 15 * depth;

                        gsap.to(layer, {
                            x: moveX,
                            y: moveY,
                            duration: 0.3,
                            ease: 'power2.out'
                        });
                    });
                });

                container.addEventListener('mouseleave', () => {
                    layers.forEach(layer => {
                        gsap.to(layer, {
                            x: 0,
                            y: 0,
                            duration: 0.5,
                            ease: 'power2.out'
                        });
                    });
                });
            }
        });

        // Mobile: scroll parallax
        if (isMobile) {
            const allLayers = document.querySelectorAll('[data-parallax] [data-depth]');

            const updateScrollParallax = () => {
                allLayers.forEach(layer => {
                    const rect = layer.closest('[data-parallax]').getBoundingClientRect();
                    const depth = parseFloat(layer.dataset.depth);

                    // Позиция контейнера относительно центра экрана
                    const centerOffset = (rect.top + rect.height / 2 - window.innerHeight / 2) / window.innerHeight;

                    const moveY = centerOffset * 30 * depth;

                    gsap.to(layer, {
                        y: moveY,
                        duration: 0.1,
                        ease: 'none'
                    });
                });
            };

            window.addEventListener('scroll', updateScrollParallax, { passive: true });
            updateScrollParallax(); // Инициализация
        }
    });
</script>

<script>
    // --------------------------------------------
    // HERO CARD CAROUSEL SLIDER
    // --------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        const container = document.querySelector('.hero-carousel-container');
        const cards = document.querySelectorAll('.hero-carousel-card');

        if (window.innerWidth >= 1024) return; // Только mobile

        const updateActiveCard = () => {
            const containerRect = container.getBoundingClientRect();
            const containerCenter = containerRect.left + containerRect.width / 2;

            let closestCard = null;
            let closestDistance = Infinity;

            cards.forEach(card => {
                const cardRect = card.getBoundingClientRect();
                const cardCenter = cardRect.left + cardRect.width / 2;
                const distance = Math.abs(containerCenter - cardCenter);

                if (distance < closestDistance) {
                    closestDistance = distance;
                    closestCard = card;
                }
            });

            cards.forEach(card => card.classList.remove('active'));
            if (closestCard) closestCard.classList.add('active');
        };

        // Прокрутка ко второй карточке при загрузке
        const scrollToCenter = () => {
            const centerCard = cards[1]; // Вторая карточка
            if (centerCard) {
                const wrapper = centerCard.closest('.hero-carousel-container > div');
                const scrollLeft = wrapper.offsetLeft - (container.offsetWidth - wrapper.offsetWidth) / 2;
                container.scrollLeft = scrollLeft;
            }
        };

        scrollToCenter();
        container.addEventListener('scroll', updateActiveCard);
        updateActiveCard();
    });
</script>

<script>
    // --------------------------------------------
    // FEATURES CAROUSEL
    // --------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        const section = document.querySelector('#features');
        const carousel = document.querySelector('.features-carousel');
        const cursor = document.querySelector('.features-cursor');
        const dots = document.querySelectorAll('.features-dot');
        const pauseBtn = document.querySelector('.features-pause');
        const pauseIcon = pauseBtn?.querySelector('.pause-icon');
        const playIcon = pauseBtn?.querySelector('.play-icon');

        if (!carousel || !section) return;

        const cards = carousel.querySelectorAll('.features-card');
        let currentIndex = 0;
        let isPlaying = true;
        let isVisible = false;
        let autoplayInterval;
        let isDragging = false;

        // Scroll to card
        const scrollToCard = (index) => {
            const card = cards[index];
            if (!card) return;

            const isMobile = window.innerWidth < 1024;
            const scrollLeft = isMobile
                ? card.offsetLeft - 20
                : card.offsetLeft - (carousel.offsetWidth - card.offsetWidth) / 2;

            carousel.scrollTo({ left: scrollLeft, behavior: 'smooth' });
        };

        // Update dots
        const updateDots = (index) => {
            dots.forEach((dot, i) => {
                dot.classList.toggle('active', i === index);
            });
            currentIndex = index;
        };

        // Autoplay
        const startAutoplay = () => {
            if (autoplayInterval) clearInterval(autoplayInterval);
            if (!isPlaying || !isVisible) return;

            autoplayInterval = setInterval(() => {
                if (!isDragging && isPlaying && isVisible) {
                    const nextIndex = (currentIndex + 1) % cards.length;
                    scrollToCard(nextIndex);
                    updateDots(nextIndex);
                }
            }, 4000);
        };

        const stopAutoplay = () => {
            clearInterval(autoplayInterval);
        };

        // Intersection Observer
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                isVisible = entry.isIntersecting;

                if (isVisible && isPlaying) {
                    startAutoplay();
                } else {
                    stopAutoplay();
                }
            });
        }, {
            threshold: 0.3 // 30% видимости
        });

        observer.observe(section);

        // Detect current card on scroll
        const onScroll = () => {
            const scrollLeft = carousel.scrollLeft;
            let closestIndex = 0;
            let closestDistance = Infinity;

            cards.forEach((card, i) => {
                const distance = Math.abs(card.offsetLeft - scrollLeft - 20);
                if (distance < closestDistance) {
                    closestDistance = distance;
                    closestIndex = i;
                }
            });

            if (closestIndex !== currentIndex) {
                updateDots(closestIndex);
            }
        };

        carousel.addEventListener('scroll', onScroll);

        // Dot click
        dots.forEach((dot, i) => {
            dot.addEventListener('click', () => {
                scrollToCard(i);
                updateDots(i);
                if (isPlaying && isVisible) startAutoplay();
            });
        });

        // Pause/Play
        pauseBtn?.addEventListener('click', () => {
            isPlaying = !isPlaying;
            pauseIcon.classList.toggle('hidden', !isPlaying);
            playIcon.classList.toggle('hidden', isPlaying);

            if (isPlaying && isVisible) {
                startAutoplay();
            } else {
                stopAutoplay();
            }
        });

        // Desktop cursor + drag
        if (cursor && window.innerWidth >= 1024) {
            let startX;
            let scrollLeft;

            carousel.addEventListener('mouseenter', () => {
                cursor.classList.add('visible');
            });

            carousel.addEventListener('mouseleave', () => {
                cursor.classList.remove('visible', 'dragging');
                isDragging = false;
            });

            carousel.addEventListener('mousemove', (e) => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';

                if (!isDragging) return;
                e.preventDefault();
                const x = e.pageX - carousel.offsetLeft;
                const walk = (x - startX) * 1.5;
                carousel.scrollLeft = scrollLeft - walk;
            });

            carousel.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.pageX - carousel.offsetLeft;
                scrollLeft = carousel.scrollLeft;
                cursor.classList.add('dragging');
            });

            carousel.addEventListener('mouseup', () => {
                isDragging = false;
                cursor.classList.remove('dragging');
            });
        }
    });
</script>

<script>
    // --------------------------------------------
    // REVIEWS CAROUSEL (Infinite + Filter)
    // --------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        const track = document.querySelector('.reviews-carousel-track');
        const prevBtn = document.querySelector('.reviews-arrow--prev');
        const nextBtn = document.querySelector('.reviews-arrow--next');
        const cursor = document.querySelector('.features-cursor');
        const filterBtns = document.querySelectorAll('.reviews-filter');

        if (!track) return;

        let originalSlides = Array.from(track.querySelectorAll('.reviews-carousel-slide'));
        if (originalSlides.length === 0) return;

        let currentFilter = 'all';

        // Определить тип отзыва по классу rating-X
        const getSlideType = (slide) => {
            const ratingEl = slide.querySelector('[class*="rating-"]');
            if (!ratingEl) return null;

            const classes = ratingEl.className;
            const match = classes.match(/rating-(\d)/);

            if (match) {
                const rating = parseInt(match[1]);
                return rating >= 4 ? 'positive' : 'negative';
            }
            return null;
        };

        // Удалить все клоны
        const removeClones = () => {
            track.querySelectorAll('.is-clone').forEach(clone => clone.remove());
        };

        // Создать клоны
        const createClones = () => {
            const visibleSlides = Array.from(track.querySelectorAll('.reviews-carousel-slide:not(.hidden):not(.is-clone)'));
            if (visibleSlides.length < 2) return;

            const clonesCount = Math.min(3, visibleSlides.length);

            visibleSlides.slice(0, clonesCount).forEach(slide => {
                const clone = slide.cloneNode(true);
                clone.classList.add('is-clone');
                track.appendChild(clone);
            });

            visibleSlides.slice(-clonesCount).forEach(slide => {
                const clone = slide.cloneNode(true);
                clone.classList.add('is-clone');
                track.insertBefore(clone, track.firstChild);
            });
        };

        // Получить ширину слайда + gap
        const getSlideWidth = () => {
            const slide = track.querySelector('.reviews-carousel-slide:not(.hidden)');
            if (!slide) return 0;
            const style = window.getComputedStyle(track);
            const gap = parseInt(style.gap) || 16;
            return slide.offsetWidth + gap;
        };

        // Начальная позиция
        const setInitialPosition = () => {
            const visibleSlides = track.querySelectorAll('.reviews-carousel-slide:not(.hidden):not(.is-clone)');
            const clonesCount = Math.min(3, visibleSlides.length);
            const slideWidth = getSlideWidth();
            track.style.scrollBehavior = 'auto';
            track.scrollLeft = slideWidth * clonesCount;
            track.style.scrollBehavior = 'smooth';
        };

        // Фильтрация
        const applyFilter = (filter) => {
            currentFilter = filter;
            removeClones();

            originalSlides.forEach(slide => {
                const type = getSlideType(slide);

                if (filter === 'all' || type === filter) {
                    slide.classList.remove('hidden');
                } else {
                    slide.classList.add('hidden');
                }
            });

            createClones();
            setTimeout(setInitialPosition, 50);
        };

        // Обновить стили кнопок
        const updateButtonStyles = (activeFilter) => {
            filterBtns.forEach(btn => {
                const filter = btn.dataset.filter;

                if (filter === activeFilter && activeFilter !== 'all') {
                    btn.classList.add('active', 'black');
                    btn.classList.remove('light');
                } else {
                    btn.classList.remove('active', 'black');
                    btn.classList.add('light');
                }
            });
        };

        // Кнопки фильтров
        filterBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const filter = btn.dataset.filter;

                // Если кликнули на активный — сбрасываем на "все"
                if (currentFilter === filter) {
                    applyFilter('all');
                    updateButtonStyles('all');
                } else {
                    applyFilter(filter);
                    updateButtonStyles(filter);
                }
            });
        });

        // Инициализация
        createClones();
        setInitialPosition();

        // Проверка бесконечного скролла
        let isJumping = false;

        const checkInfiniteScroll = () => {
            if (isJumping) return;

            const visibleSlides = track.querySelectorAll('.reviews-carousel-slide:not(.hidden):not(.is-clone)');
            const clonesCount = Math.min(3, visibleSlides.length);
            const slideWidth = getSlideWidth();
            const scrollLeft = track.scrollLeft;
            const maxScroll = track.scrollWidth - track.offsetWidth;

            if (scrollLeft < slideWidth * (clonesCount - 1)) {
                isJumping = true;
                track.style.scrollBehavior = 'auto';
                track.scrollLeft = scrollLeft + slideWidth * visibleSlides.length;
                track.style.scrollBehavior = 'smooth';
                setTimeout(() => isJumping = false, 50);
            }

            if (scrollLeft > maxScroll - slideWidth * (clonesCount - 1)) {
                isJumping = true;
                track.style.scrollBehavior = 'auto';
                track.scrollLeft = scrollLeft - slideWidth * visibleSlides.length;
                track.style.scrollBehavior = 'smooth';
                setTimeout(() => isJumping = false, 50);
            }
        };

        track.addEventListener('scroll', checkInfiniteScroll);

        // Прокрутка
        const scrollToDirection = (direction) => {
            const slideWidth = getSlideWidth();
            const currentScroll = track.scrollLeft;

            if (direction === 'next') {
                track.scrollTo({ left: currentScroll + slideWidth, behavior: 'smooth' });
            } else {
                track.scrollTo({ left: currentScroll - slideWidth, behavior: 'smooth' });
            }
        };

        // Стрелки
        if (prevBtn) prevBtn.addEventListener('click', () => scrollToDirection('prev'));
        if (nextBtn) nextBtn.addEventListener('click', () => scrollToDirection('next'));

        // Desktop: drag + cursor
        if (window.innerWidth >= 1024 && cursor) {
            let isDragging = false;
            let startX;
            let scrollLeft;

            track.style.cursor = 'none';

            track.addEventListener('mouseenter', () => {
                cursor.classList.add('visible');
            });

            track.addEventListener('mouseleave', () => {
                cursor.classList.remove('visible', 'dragging');
                isDragging = false;
            });

            track.addEventListener('mousemove', (e) => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';

                if (!isDragging) return;
                e.preventDefault();
                const x = e.pageX;
                const walk = (x - startX) * 1.5;
                track.scrollLeft = scrollLeft - walk;
            });

            track.addEventListener('mousedown', (e) => {
                isDragging = true;
                startX = e.pageX;
                scrollLeft = track.scrollLeft;
                cursor.classList.add('dragging');
            });

            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    cursor.classList.remove('dragging');
                }
            });
        }

        // Клавиатурная навигация
        document.addEventListener('keydown', (e) => {
            const rect = track.getBoundingClientRect();
            const isVisible = rect.top < window.innerHeight && rect.bottom > 0;

            if (!isVisible) return;

            if (e.key === 'ArrowLeft') scrollToDirection('prev');
            if (e.key === 'ArrowRight') scrollToDirection('next');
        });

        // Resize
        window.addEventListener('resize', () => {
            removeClones();
            createClones();
            setInitialPosition();
        });
    });
</script>

<script>
    // --------------------------------------------
    // EVENTS GALLERY (Infinite Scroll)
    // --------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        const gallery = document.querySelector('.events-gallery');
        if (!gallery) return;

        const isDesktop = window.innerWidth >= 1024;
        const rows = gallery.querySelectorAll('.events-gallery_row');

        // Вычисляем размер всех row'ов
        let totalSize = 0;
        rows.forEach(row => {
            totalSize += isDesktop ? row.offsetHeight : row.offsetWidth;
        });

        // Добавляем gaps
        const style = window.getComputedStyle(gallery);
        const gap = parseInt(isDesktop ? style.rowGap : style.columnGap) || 0;
        totalSize += gap * rows.length;

        // Дублируем контент
        const content = gallery.innerHTML;
        gallery.innerHTML = content + content;

        gallery.style.setProperty('--scroll-size', `-${totalSize}px`);
    });
</script>

<script>
    // --------------------------------------------
    // BLOG CAROUSEL
    // --------------------------------------------
    document.addEventListener('DOMContentLoaded', () => {
        const track = document.querySelector('.blog-carousel-track');
        const cursor = document.querySelector('.features-cursor');

        if (!track) return;

        // Отключаем drag для всех элементов внутри
        track.addEventListener('dragstart', (e) => {
            e.preventDefault();
        });

        // Desktop: drag + cursor
        if (window.innerWidth >= 1024 && cursor) {
            let isDragging = false;
            let hasMoved = false;
            let startX;
            let scrollLeft;
            const dragThreshold = 5; // Порог в пикселях

            track.addEventListener('mouseenter', () => {
                cursor.classList.add('visible');
            });

            track.addEventListener('mouseleave', () => {
                cursor.classList.remove('visible', 'dragging');
                isDragging = false;
            });

            track.addEventListener('mousemove', (e) => {
                cursor.style.left = e.clientX + 'px';
                cursor.style.top = e.clientY + 'px';

                if (!isDragging) return;

                const x = e.pageX;
                const distance = Math.abs(x - startX);

                // Если сдвинули больше порога — это drag
                if (distance > dragThreshold) {
                    hasMoved = true;
                    e.preventDefault();
                }

                const walk = (x - startX) * 1.5;
                track.scrollLeft = scrollLeft - walk;
            });

            track.addEventListener('mousedown', (e) => {
                isDragging = true;
                hasMoved = false;
                startX = e.pageX;
                scrollLeft = track.scrollLeft;
                cursor.classList.add('dragging');
            });

            document.addEventListener('mouseup', () => {
                if (isDragging) {
                    isDragging = false;
                    cursor.classList.remove('dragging');
                }
            });

            // Блокируем клик если был drag
            track.addEventListener('click', (e) => {
                if (hasMoved) {
                    e.preventDefault();
                    e.stopPropagation();
                }
            }, true);
        }
    });
</script>

{% endblock %}

{% endblock %}
